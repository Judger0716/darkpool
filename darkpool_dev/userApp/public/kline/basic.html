<!DOCTYPE html>
<html lang="en" style="background: #FFFFFF;height: 100%">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="KLineChart example" />

    <title>KLineChart_GOLD/RMB</title>

    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="enroutedigitallab">
    <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Google Font -->
    <link
        href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i%7CRoboto:300,300i,400,400i,500,500i,700,700i"
        rel="stylesheet">
    <!-- Bootstrap css-->
    <link rel="stylesheet" href="/public/css/bootstrap.min.css">
    <!-- Font Awesome css-->
    <!--<link rel="stylesheet" href="/public/css/font-awesome.min.css">-->
    <link rel="stylesheet" href="/public/css/ionicons.min.css">
    <!-- animate css-->
    <link rel="stylesheet" href="/public/css/animate.min.css">
    <!-- REVOLUTION SLIDER STYLES -->
    <link rel="stylesheet" type="text/css" href="/public/css/settings.css">
    <link rel="stylesheet" type="text/css" href="/public/css/layers.css">
    <link rel="stylesheet" type="text/css" href="/public/css/navigation.css">
    <!-- Owl Carousel -->
    <link rel="stylesheet" href="/public/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/public/css/owl.theme.default.min.css">
    <!-- custom menu css-->
    <link rel="stylesheet" href="/public/css/custom-menu.css">
    <!-- c3 min css-->
    <link rel="stylesheet" href="/public/css/c3.min.css">
    <!-- Style css-->
    <link rel="stylesheet" href="/public/css/style.css">
    <!-- Responsive css-->
    <link rel="stylesheet" href="/public/css/responsive.css">
    <!-- Modernizr js-->
    <script src="/public/js/modernizr-2.8.3.min.js"></script>

    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/klinecharts@7.3.2/dist/klinecharts.min.js"></script>
    <!-- Local Installation of KlineCharts
    <script type="text/javascript" src="../kline/klinecharts.min.js"></script>
    -->
    <script type="text/javascript" src="../kline/kline_gold_sliver.js"></script>

    <!-- CDN 安装 Vue&ElementUI -->
    <script src="https://unpkg.com/vue@2.6.12/dist/vue.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui@2.14.1/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui@2.14.1/lib/index.js"></script>
    <script src="https://unpkg.com/axios@0.21.0/dist/axios.min.js"></script>

    <!-- 本地安装 Vue&ElementUI
        <script src="../../static/vue.js"></script>
        <link rel="stylesheet" href="../../static/index.css">
        <script src="../../static/index.js"></script>
        <script src="../../static/axios.min.js"></script>
    -->

    <style>
        * {
            font-family: 'Roboto';
        }

        .el-table th {
            background-color: #F8F8F8;
        }

        .el-table tr {
            background-color: #F8F8F8;
        }

        .el-table__body-wrapper::-webkit-scrollbar {
            width: 10px;
        }

        .el-table__body-wrapper::-webkit-scrollbar-thumb {
            background-color: #919399;
            border-radius: 8px;
        }
    </style>

</head>

<body style="margin: 0;height: 100%">

    <!--Preloader-->
    <div class="preloader">
        <div class="loading"></div>
    </div>
    <!--/.preloader-->

    <!--header-->
    <header class="stricky">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <nav id="cssmenu">
                        <div class="logo">
                            <a href="/"><img src="/public/images/logo.png" alt=""></a>
                        </div>
                        <div id="head-mobile"></div>
                        <div class="button"></div>
                        <ul class="pull-right header-list">
                            <li><a href="/"><span class="glyphicon glyphicon-home">首页</span></a>
                            </li>
                            <li><a href="/public/kline/basic.html"><span
                                        class="glyphicon glyphicon glyphicon-stats">查看行情</span></a></li>
                            <li><a href="/public/tutorial.html"><span
                                        class="glyphicon glyphicon-info-sign">快速入门</span></a></li>
                            <li><a href="/public/block_explorer.html"><span
                                        class="glyphicon glyphicon-globe">区块浏览</span></a></li>
                            <li><a href="#" onClick="javascript :history.back(-1);"><span
                                        class="glyphicon glyphicon-backward"></span>返回</a></li>
                        </ul>
                        <!--/.pull-right-->
                    </nav>
                    <!--/#cssmenu-->
                </div>
            </div>
        </div>
    </header>
    <!--/header-->

    <div class="banner-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="banner-title text-center">
                        <h2 style="font-family: Lora, serif; font-weight: 700;">行情实时查看</h2>
                        <h2 style="font-family: Lora, serif; font-weight: 700;">GOLD/RMB</h2>
                    </div>
                </div>
            </div>
            <!--/.row-->
        </div>
        <!--/.container-->
    </div>
    <!--/.banner-section-->

    <section class="bg-deep about-content-section" id="kline">
        <div class="container">
            <a href="#" class="btn btn-primary btn-lg active" role="button">GOLD/RMB</a>
            <a href="/public/kline/carbon.html" class="btn btn-default btn-lg active" role="button">CARBON/RMB</a>
            <div class="row row-eq-height">
                <div class="col-md-12 col-sm-6">
                    <div class="about-inner" id="chart"></div>
                    <!--/.about-inner-->
                </div>
            </div>
            <!--/.row-->
        </div>
        <!--/.container-->
        <div class="container" style="margin-bottom: 20px;">
            <div class="row row-eq-height">
                <div class="col-md-12 col-sm-6">
                    <div class="about-inner-text-content">
                        <el-table :data="klineList_rev" height="450" style="width: 100%; background-color: #F8F8F8;">
                            <el-table-column prop="timestr" label="日期" width="250">
                            </el-table-column>
                            <el-table-column prop="open" label="开盘价" width="150">
                            </el-table-column>
                            <el-table-column prop="close" label="收盘价" width="150">
                            </el-table-column>
                            <el-table-column prop="high" label="最高价" width="150">
                            </el-table-column>
                            <el-table-column prop="low" label="最低价" width="150">
                            </el-table-column>
                            <el-table-column prop="volume" label="成交量">
                            </el-table-column>
                        </el-table>
                    </div>
                    <!--/.about-inner-text-content-->
                </div>
            </div>
            <!--/.row-->
        </div>
        <!--/.container-->
    </section>
    <!--/.about-section-->

    <section class="footer-area">
        <div class="container">
            <div class="row footer-banner row-eq-height">
                <div class="col-md-6 col-sm-6">
                    <div class="footer-content">
                        <div class="footer-logo">
                            <a href="/"><img src="/public/images/footer-logo.png" alt=""></a>
                        </div>
                        <div class="text-content">
                            <p>本平台致力于打造全球规模最大的暗池交易系统</p>
                            <p>加入CryptoPool，成为我们的一员</p>
                        </div>
                    </div>
                    <!--/.footer-content-->
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="footer-content">
                        <h4><a href="#">最近要闻</a></h4>
                        <ul>
                            <li><a href="#">平台动态</a></li>
                            <li><a href="#">市场快报</a></li>
                            <li><a href="#">投资建议</a></li>
                            <li><a href="#">商业合作</a></li>
                        </ul>
                    </div>
                    <!--/.footer-content-->
                </div>
                <div class="col-md-3 col-sm-6 col-xs-6">
                    <div class="footer-content">
                        <h4><a href="#">友情链接</a></h4>
                        <ul>
                            <li><a href="../public/tutorial.html">快速入门</a></li>
                            <li><a href="../public/kline/basic.html">查看行情</a></li>
                            <li><a href="../public/block_explorer.html">区块浏览</a></li>
                            <li><a href="#">联系我们</a></li>
                        </ul>
                    </div>
                    <!--/.footer-content-->
                </div>
            </div>
            <!--/.rwo footer-banner-->
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6 col-sm-6">
                        <div class="copyright-info">
                            <p>Copyright &copy; 2021.CryptoPool All rights reserved.</p>
                        </div>
                    </div>
                    <!--/.copyright-info-->
                    <div class="col-md-6 col-sm-6">
                        <div class="social text-right content-align">
                            <ul>
                                <li><a href="#"><i><img src="/public/images/footer/wechat.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                                <li><a href="#"><i><img src="/public/images/footer/alipay.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                                <li><a href="#"><i><img src="/public/images/footer/weibo.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                                <li><a href="#"><i><img src="/public/images/footer/facebook.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                                <li><a href="#"><i><img src="/public/images/footer/twitter.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                                <li><a href="#"><i><img src="/public/images/footer/ins.png"
                                                style="height: 18px; width: 18px;"></i></a></li>
                            </ul>
                        </div>
                        <!--/.social-->
                    </div>
                </div>
            </div>
            <!--/.copyright-->
        </div>
        <!--/.contianer-->
    </section>
    <!--/.footer area-->

    <script>
        // 引入Vue变量控制kline
        var kline = new Vue({
            el: "#kline",
            data: {
                old_value: {},
                new_value: {},
                klineList: [],
                klineList_rev: [],
            },
            methods: {
                query_new_value() {
                    axios.post('/query_new_value', {
                        'old_value': this.old_value,
                    }).then(Response => {
                        this.new_value = Response['data']['new_value'];
                        if (this.new_value) {
                            this.klineList.push(this.new_value);
                            this.klineList_rev.unshift(this.new_value);
                            this.old_value = this.new_value;
                        }
                    })
                },
            },
            created: function () {
                axios.post('/init_kline', {
                    'GOLD_SLIVER': true,
                }).then(Response => {
                    this.klineList = Response['data']['init_klineList'];
                    this.klineList_rev = Response['data']['init_klineList_rev'];
                    this.old_value = this.klineList[this.klineList.length - 1];
                })
            }
        })
        // kline绘图,页面加载时初始化
        var chart = klinecharts.init('chart')
        var chartDataList = []
        window.onload = function draw_kline() {
            chart.createTechnicalIndicator('MA', false, { id: 'candle_pane' })
            chart.createTechnicalIndicator('VOL')
            chart.createTechnicalIndicator('MACD')
            axios.post('/init_kline', {
                'GOLD_SLIVER': true,
            }).then(Response => {
                let klineList = Response['data']['init_klineList'];
                chart.applyNewData(klineList);
            })
            /*
            chartDataList = kLineDataList.map(function (data) {
                return {
                    timestamp: new Date(data[0]).getTime(),
                    open: +data[1],
                    high: +data[2],
                    low: +data[3],
                    close: +data[4],
                    volume: Math.ceil(+data[5]),
                }
            })
            chart.applyNewData(chartDataList)
            */
        }
        // 随后按照间隔不断更新
        window.setInterval(() => {
            setTimeout(function () {
                kline.query_new_value()
                chart.applyNewData(kline.klineList)
            }, 600)
        }, 5000)
    </script>

    <!-- == jQuery Librery == -->
    <script src="/public/js/jquery-3.3.1.min.js"></script>
    <!-- == Bootsrap js File == -->
    <script src="/public/js/bootstrap.min.js"></script>
    <!-- == wow min js == -->
    <script src="/public/js/wow.min.js"></script>
    <!-- == Custom Menu js == -->
    <script src="/public/js/custom-menu.js"></script>
    <!-- == Custom Counter js == -->
    <script src="/public/js/custom-counter.js"></script>
    <script src="/public/js/Chart.min.js"></script>
    <script src="/public/js/active-chart.js"></script>
    <!-- == Prallex js == -->
    <script src="/public/js/prallex.js"></script>
    <!-- == Owl Carousel  == -->
    <script src="/public/js/owl.carousel.min.js"></script>
    <!-- == Revolution Slider JS == -->
    <script src="/public/js/revolution/jquery.themepunch.tools.min.js"></script>
    <script src="/public/js/revolution/jquery.themepunch.revolution.min.js"></script>
    <script src="/public/js/revolution/extensions/revolution.extension.actions.min.js"></script>
    <script src="/public/js/revolution/extensions/revolution.extension.layeranimation.min.js"></script>
    <script src="/public/js/revolution/extensions/revolution.extension.navigation.min.js"></script>
    <script src="/public/js/revolution/extensions/revolution.extension.parallax.min.js"></script>
    <script src="/public/js/revolution/extensions/revolution.extension.slideanims.min.js"></script>
    <script src="/public/js/revolution-active.js"></script>
    <!-- == Custom js  == -->
    <script src="/public/js/custom.js"></script>

</body>

</html>